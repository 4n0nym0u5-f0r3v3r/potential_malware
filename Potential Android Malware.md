Malware strain: Trojan
Possibly: Banker Trojan

# ‚ö†Ô∏è üö® I got this malware sample from a WhatsApp group, i strongly recommend don't install this on a real device for any purpose üö® ‚ö†Ô∏è

Let's start by explaining how I got suspicious
1) As you can see in the below screenshot their is check mark/tick mark which is not a real way of showing a verification badge or in other words verified status
2) Some one changed the group name to "State Bank Of India" where as if this message would have sent from SBI (State Bank Of India) their would be having a new chat instead of saying like this
3) If this was a legit information from bank then they would have sent the google playstore link instead of .apk file
4) Here the threat actor is luring us with "‚Çπ 6350" and playing with mind to act fast without thinking by saying "will expire TONIGHT"
5) Wording is also weird for me "Reward point INR" is another red flag

![WaGroup](WaGroup.jpg)

At this point i was 99% sure this was malware but for making sure i'm not imagining stuff out of obvious reasons i started doing static analysis of this apk so i ran strings to extract any possible bread crumbs for further digging of this malware Nothing special, but I found foreign languages that are not typically used by Indians which feels odd since the bank name which they are using is State Bank Of India is national authorised bank so they could be having Indian languages like Hindi, Kannada, Telugu, Marathi, Tamil etc and For those who don't understand the local languages, they have the option to use English (This is my speculation not confirmed info) In this malware sample, English and other foreign languages are found example Espa√±ol
For further digging i decompressed the apk and went inside assets folder in their i found index.html out of curiosity viewed it with Text editor and found url to the phishing link
here is the defanged url 
`hxxps[://]udemotech[.]cloud/icare4[.]elviainfotech[.]one[.]SBIRewards/CFx/`
URL itself is suspicious for me since the TLD is ".cloud" which i have never seen to be used by government websites
To obtain more details about the URL, I performed a WHOIS lookup and discovered that the domain is registered with Hostinger and its IP address is hosted on a cloudflare server. At the moment of writing, the link remains active. Unfortunately, I'm unsure of the process to report this link as a malicious one.

![Webpage](Webpage.png)

As we can see, it is taking critical information of the user, such as "Username", "Password", and "Mobile"
by further poking this found this

```
{
	"POST": {
		"scheme": "https",
		"host": "udemotech.cloud",
		"filename": "/icare4.elviainfotech.one.SBIRewards/CFx/post.php",
		"remote": {
			"Address": "0.0.0.0:443"
		}
	}
}
```

this is the response header

```
HTTP/2 200 OK
date: Fri, 04 Oct 2024 08:07:48 GMT
content-type: text/html; charset=UTF-8
x-powered-by: PHP/8.1.29
set-cookie: PHPSESSID=pna2788c5idgtc2pvqfbehc5hf; path=/; secure
expires: Thu, 19 Nov 1981 08:52:00 GMT
cache-control: no-store, no-cache, must-revalidate
pragma: no-cache
platform: hostinger
panel: hpanel
x-turbo-charged-by: LiteSpeed
cf-cache-status: DYNAMIC
report-to: {"endpoints":[{"url":"https:\/\/a.nel.cloudflare.com\/report\/v4?s=gCV2ulfLJ5L2%2FoEi2u7KurcrrXAOY%2B83zK2EC9IK9pe0smWPlYFLUc%2BXImdZ5DKA4ryJSMHY9AUUhc45avWAamQqqCx1rHgnjgq6FbbyB%2BPx2%2F4aenoZ9c%2Bzjh08HZkqcdvb%2BvmaEnJBgtAoPq4%3D"}],"group":"cf-nel","max_age":604800}
nel: {"success_fraction":0,"report_to":"cf-nel","max_age":604800}
server: cloudflare
cf-ray: 8cd3ae2b5adc156b-SJC
content-encoding: br
alt-svc: h2="cflares35lvdlczhy3r6qbza5jjxbcplzvdveabhf7bsp7y4nzmn67yd.onion:443"; ma=86400; persist=1
X-Firefox-Spdy: h2
```

this is the request header

```
POST /icare4.elviainfotech.one.SBIRewards/CFx/post.php HTTP/2
Host: udemotech.cloud
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://udemotech.cloud/icare4.elviainfotech.one.SBIRewards/CFx/index.html
Content-Type: application/x-www-form-urlencoded
Content-Length: 59
Origin: https://udemotech.cloud
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: iframe
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
```

![browserconsole](browserconsole.png)

this is the screenshot of console of browser i don't actually know what really happening here but what i'm thinking here is this is checking whether the link is being accessed by tor(The Onion Router) or not and some thing with port again i admit i'm really not sure what is happening here or im going crazy or it might be normal thing to exist due to cloudflare
but i think it's some kind of RCE beacon i need to do more finding in "patchWindow.js" file

![morecreds](MoreCreds.png)

this is the screenshot of pssdb.html as we can see it is taking more details of user, such as "Account Holder Name", "Aadhaar Number", "Date Birth". and i have noticed the title of the page is saying "Well Come" but in index.html it says "Welcome" in pssdb.html file instead of saying "Date of birth" it is saying "Date Birth". and if you try to send GET request for file which might not exist like "asfasdfasdfasdfasdfasdf.html" instead of returning 404 HTTP status code it returns "Soul is Immortal:)" as response

![accdetails](AccDetails.png)

this is the screenshot of cf.html it is taking account informations "Account Number", "CIF Number" in html file they commented out the pan card details taking part, and this page also says "Well Come" in title

![carddetails](CardDetails.png)

this is the screenshot of dbv.html it is taking Card details "Debit/Credit Card Number", "Expiry Date", "CVV", "ATM Pin"

![profile](Profile.png)

this is the screenshot of profile.html it is taking "Profile Password" and sending it to tok.html

![profile](OTP.png)

this is the screenshot of tok.html it is taking "One Time Password" otp as input

i went to check wether this particular malware sample was submitted to Virustotal website to do that i ran the command below

```
sha256sum SBI\ REWARD.APK
```

got this response

```
c82f0ca1b84241c0ecd3b6932cb6409820e0a88e014fba0f456c75ffaaf08442  SBI REWARD.APK
```

their was no report for this file hash so i uploaded the file to virustotal

```
https://www.virustotal.com/gui/file/c82f0ca1b84241c0ecd3b6932cb6409820e0a88e014fba0f456c75ffaaf08442/detection
```

in case you guys also want to check the virustotal report, it did say my assumptions were true that is the malware is trojan and banker tag, after  seeing the behaviour tab now i'm thinking it can also be a infostealer ( my speculation )

after that i went to true caller to check who owns the number from which the message has sent 
name it showed as '[REDACTED] Ahmed Praveen [REDACTED]'
for their privacy reason and ethics i'm not giving their number and it can also be possible that the message has been sent after taking over the user account

PS i'm not a professional Cybersecurity expert or any other kind of wordings
